
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Derivation of Foundational Equations &#8212; Solving Wave Scattering using Machine Learning</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Perfectly Matched Layers" href="PML.html" />
    <link rel="prev" title="Introduction" href="intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Solving Wave Scattering using Machine Learning</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Main Thread
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Derivation of Foundational Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PML.html">
   Perfectly Matched Layers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="test_problem.html">
   Test Problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="full_first_comp.html">
   Integral Comparison
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Mathematical Supplementals
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="taylor_facts.html">
   Key Facts and Theorems
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/scatter_maths.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fscatter_maths.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="derivation-of-foundational-equations">
<h1>Derivation of Foundational Equations<a class="headerlink" href="#derivation-of-foundational-equations" title="Permalink to this headline">¶</a></h1>
<p>In order to fully illuminate the methodology and structure behind the model that Yuwei Fan et al. decided to use we must first understand the underlying mathematics behind the scenario they wished to model. I will be following their derivation here and expanding upon it where I find components of their derivation confusing.</p>
<p><strong>Definitions and Assumptions</strong></p>
<p>Let us define <span class="math notranslate nohighlight">\(\Omega\)</span> as a compact domain of interest. We can define the inhomogeneous media scattering problem with a fixed frequency wave, <span class="math notranslate nohighlight">\(\omega\)</span>, to be modelled by the Helmholtz equation</p>
<div class="math notranslate nohighlight">
\[Lu:= \left(-\Delta- \frac{\omega^2}{c^2(x)}\right)\]</div>
<p>with <span class="math notranslate nohighlight">\(c^2(x)\)</span> being an unknown velocity field. Assume there exists a known background velocity, <span class="math notranslate nohighlight">\(c_0(x)\)</span> such that <span class="math notranslate nohighlight">\(c(x)\)</span> is identical to <span class="math notranslate nohighlight">\(c_0(x)\)</span> outside the domain <span class="math notranslate nohighlight">\(\Omega\)</span>.</p>
<p>We define the scatterer, <span class="math notranslate nohighlight">\(\eta(x)\)</span> as</p>
<div class="math notranslate nohighlight">
\[\eta(x) := \left(\frac{\omega^2}{c^2(x)} - \frac{\omega^2}{c_0^2(x)}\right)\]</div>
<p>which we can see is compactly supported in <span class="math notranslate nohighlight">\(\Omega\)</span> as <span class="math notranslate nohighlight">\(c^2(x)\)</span> is equal to <span class="math notranslate nohighlight">\(c_0^2(x)\)</span> outside <span class="math notranslate nohighlight">\(\Omega\)</span>.</p>
<p>We can now define the operator</p>
<div class="math notranslate nohighlight">
\[L_0:= -\Delta - \frac{\omega^2}{c_0^2(x)} =  -\Delta - \omega^2 \]</div>
<p>with out loss of generality, we can set <span class="math notranslate nohighlight">\(c_0(x)\)</span> to be constant, for convenience we set <span class="math notranslate nohighlight">\(c_0(x)\equiv1\)</span>. We may then also redefine</p>
<div class="math notranslate nohighlight">
\[L:=L_0-\eta(x)\]</div>
<p>The sources can be seen to be incident anywhere on the boundary of <span class="math notranslate nohighlight">\(\Omega\)</span> and denoted as <span class="math notranslate nohighlight">\(s\)</span> and be parameterised by <span class="math notranslate nohighlight">\(s\in[0,2\pi)\)</span>.  Furthermore, we can represent each source wave as an incoming plane wave</p>
<div class="math notranslate nohighlight">
\[e^{i\omega\hat{s} \cdot x}\]</div>
<p>with <span class="math notranslate nohighlight">\(\hat{s} = (\cos(x), \sin(x))\)</span> or <span class="math notranslate nohighlight">\(\hat{s} \in \mathbb{S}^1\)</span> being the direction of incidence. We denote the scattered wave by <span class="math notranslate nohighlight">\(u^s(x)\)</span> which satisfies the following equation.</p>
<div class="math notranslate nohighlight">
\[\left(L_0 - \eta(x)\right) \left(e^{i\omega\hat{s}x} + u^s(x)\right) = 0 \tag{1}\]</div>
<p>As well as the Somerfield radiation boundary condition</p>
<div class="math notranslate nohighlight">
\[\lim_{|x|\to\infty}|x|^{\frac{1}{2}}\left(\frac{\partial}{\partial|x|} - ik\right)u(x)=0\]</div>
<p>We need this to be true so that our field is continous.</p>
<p>Similar to the sources, we can denote the ‘recorded’ far field pattern <span class="math notranslate nohighlight">\(r\)</span>, and let them  be parameterised by <span class="math notranslate nohighlight">\(r \in [0,2\pi)\)</span>. Once again, we will denote <span class="math notranslate nohighlight">\(\hat{r} = (\cos(x), \sin(x))\)</span> or <span class="math notranslate nohighlight">\(\hat{r} \in \mathbb{S}^1\)</span> being the direction of emission. With this we can define <span class="math notranslate nohighlight">\(\hat{u}^s(x)\)</span> to be the far field pattern recorded in direction <span class="math notranslate nohighlight">\(\hat{r}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\hat{u}^s(x)\equiv\lim_{\rho\to\infty}\sqrt{\rho}e^{-i\omega\rho}u^s(\rho\cdot\hat{r})\]</div>
<p>We can then denote <span class="math notranslate nohighlight">\(d(s,r)\)</span> to be the set of all far field patterns from a source <span class="math notranslate nohighlight">\(s\in S\)</span> to a direction <span class="math notranslate nohighlight">\(r\in R\)</span> by <span class="math notranslate nohighlight">\(d(s,r)\equiv\hat{u}^s(x)\)</span></p>
<p><strong>Relationship between source waves and scattered wave for far field waves</strong></p>
<p>In order to solve either the forward map or inverse problem we must better understand the relationship between <span class="math notranslate nohighlight">\(\eta(x)\)</span> and <span class="math notranslate nohighlight">\(d(s,r)\)</span>. We can do this by doing a perturbative analysis for a small <span class="math notranslate nohighlight">\(\eta(x)\)</span>. We can do this by expanding (1)</p>
<div class="math notranslate nohighlight">
\[\left(L_0 - \eta(x)\right) \left(e^{i\omega\hat{s}x} + u^s(x)\right) = 0\]</div>
<div class="math notranslate nohighlight">
\[\Leftrightarrow \left(L_0 - \eta(x)\right) u^s(x) = \left(L_0 - \eta(x)\right)e^{i\omega\hat{s}x}\]</div>
<div class="math notranslate nohighlight">
\[\Leftrightarrow L_0 \cdot u^s(x)-\eta(x)\cdot u^s(x) = L_o \cdot e^{i\omega\hat{s}x}-\eta(x)\cdot e^{i\omega\hat{s}x}\]</div>
<p>As <span class="math notranslate nohighlight">\(u^s(x)\)</span> is dependent on <span class="math notranslate nohighlight">\(\eta(x)\)</span> and we are looking only at small perturbations from <span class="math notranslate nohighlight">\(\eta(x) = 0\)</span> we can combine them into higher order <span class="math notranslate nohighlight">\(\eta(x)\)</span> terms</p>
<div class="math notranslate nohighlight">
\[L_0 \cdot u^s(x)+o(\eta)= L_o \cdot e^{i\omega\hat{s}x}-\eta(x)\cdot e^{i\omega\hat{s}x}\]</div>
<p>And we know that <span class="math notranslate nohighlight">\(L_0 \cdot e^{i\omega\hat{s}x} = 0\)</span>, so we arrive at</p>
<div class="math notranslate nohighlight">
\[\left(L_0 \cdot u^s\right)(x)= \eta(x)\cdot e^{i\omega\hat{s}x}+o(\eta)\tag{2}\]</div>
<p>We can now let the inverse of the operator, <span class="math notranslate nohighlight">\(L_0^{-1} = G_0\)</span>, to be the integral kernel of Green functions of the free space Helmholtz operator, <span class="math notranslate nohighlight">\(L_0\)</span>. Doing so, as well as allowing <span class="math notranslate nohighlight">\(o(\eta(x))\to0\)</span> as we are looking at <span class="math notranslate nohighlight">\(\eta(x)\)</span> close to 0, can rewrite (2) as</p>
<div class="math notranslate nohighlight">
\[u^s(x) = \int G_0(y-x)\eta(x)e^{i\omega\hat{s}\cdot x}\, dx\tag{3}\]</div>
<p>We can now apply the Green function of the free space Helmholtz operator expansion at infinity</p>
<div class="math notranslate nohighlight">
\[G_0(z) = \frac{e^{iwz}+o(1)}{\sqrt{|z|}}\]</div>
<p>Applying this to (3) and combining with equation (1), we can compute <span class="math notranslate nohighlight">\(\hat{u}^s(x)\)</span></p>
<div class="math notranslate nohighlight">
\[\hat{u}^s(x)=\lim_{\rho\to\infty}\sqrt{\rho}e^{-i\omega\rho}u^s(\rho\cdot\hat{r})\approx\lim_{\rho\to\infty}\sqrt{\rho}e^{i\omega\rho}
\int\left(\frac{e^{iw(\rho-\hat{r}\cdot x)}}{\sqrt{\rho}}\eta(x)e^{-i\omega\hat{s}\cdot x}\right)\, dx\]</div>
<p>Which we can expand it out and simplify to</p>
<div class="math notranslate nohighlight">
\[=\int e^{-iw(\hat{r}-\hat{s})\cdot x}\eta(x)\, dx = d_1(s,r)\]</div>
<p>With <span class="math notranslate nohighlight">\(d_1(s,r)\)</span> denoting the first order approximation to <span class="math notranslate nohighlight">\(d(s,r)\)</span> with respect to <span class="math notranslate nohighlight">\(\eta(x)\)</span>.</p>
<p><strong>Problem Setup</strong></p>
<p>As we are dealing with the far field pattern problem, we can approximate <span class="math notranslate nohighlight">\(\Omega\)</span> as the unit disk centred at the origin and can treat <span class="math notranslate nohighlight">\(\hat{s}\)</span> and <span class="math notranslate nohighlight">\(\hat{r}\)</span> as uniformly sampled from <span class="math notranslate nohighlight">\(\mathbb{S}^1\)</span>. We can denote this by setting <span class="math notranslate nohighlight">\(s=\frac{2\pi j}{N_s}\)</span> and <span class="math notranslate nohighlight">\(r=\frac{2\pi k}{N_r}\)</span> with setting <span class="math notranslate nohighlight">\(N_s = N_r\)</span>. As we are now assuming that <span class="math notranslate nohighlight">\(\Omega\)</span> is the unit disc, it will now be useful to use polar coordinates. We may define <span class="math notranslate nohighlight">\(x=\left(\rho\cos(\theta),\rho\sin(\theta)\right)\)</span> with <span class="math notranslate nohighlight">\(\rho \in [0,1]\)</span> and <span class="math notranslate nohighlight">\(\theta \in [0,2\pi)\)</span>. As we also have the direction of the source, <span class="math notranslate nohighlight">\(s\in[0,2\pi)\)</span> and the direction of our scattering measurement, <span class="math notranslate nohighlight">\(r\in[0,2\pi)\)</span>; it is suggested to use a change of variables</p>
<div class="math notranslate nohighlight">
\[m=\frac{r+s}{2},h=\frac{r-s}{2}\]</div>
<p>With <span class="math notranslate nohighlight">\(m,h,r,s\)</span> are all modulo <span class="math notranslate nohighlight">\(2\pi\)</span>. We can also trivially redefine</p>
<div class="math notranslate nohighlight">
\[d(s,r) \text{ to } d(m,h)\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\eta(x)\text{ to }\eta(\rho,\theta)\]</div>
<p>in our new polar coordinates. As <span class="math notranslate nohighlight">\(d_1(m,h)\)</span> is linear in terms of <span class="math notranslate nohighlight">\(\eta(\rho,\theta)\)</span> there exists a linear operator mapping</p>
<div class="math notranslate nohighlight">
\[d_1(m,h) \to \eta(\rho,\theta)\]</div>
<p>As this is a mapping from a function space to a function space there exists a kernel operator <span class="math notranslate nohighlight">\(K(m,h,\rho,\theta)\)</span> such that</p>
<div class="math notranslate nohighlight">
\[d_1(m,h) = \int_{0}^{1} \int_{0}^{2\pi} K(m,h,\rho,\theta)\cdot \eta(\rho,\theta)\,\, d\theta \, d\rho\]</div>
<p>As the external velocity field is constant, <span class="math notranslate nohighlight">\(c_0=1\)</span>, and the problem is defined on the unit disc centred at the origin; the system is symmetric with respect to <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(h\)</span>.<a class="footnote-reference brackets" href="#id2" id="id1">1</a>
This allows us to simplify the system significantly.</p>
<p>=======================</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>I understand that the system is fully symmetric with respect to <span class="math notranslate nohighlight">\(s\)</span> as there is not preference to the incidence wave. But surely due to the internal structure of <span class="math notranslate nohighlight">\(\Omega\)</span> would vary with respect to <span class="math notranslate nohighlight">\(r\)</span>. Or in a more to phrase it more mathematically, the variation of <span class="math notranslate nohighlight">\(\eta(\rho,\theta)\)</span> within <span class="math notranslate nohighlight">\(\Omega\)</span> would change <span class="math notranslate nohighlight">\(\hat{u}^s(\rho,\theta)\)</span> so that at a given point <span class="math notranslate nohighlight">\(r\)</span>, we would measure a different wave?</p>
</dd>
</dl>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">Introduction</a>
    <a class='right-next' id="next-link" href="PML.html" title="next page">Perfectly Matched Layers</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Emilio McAllister Fognini<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>